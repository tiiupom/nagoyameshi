<!DOCTYPE html> 
<html xmlns:th="https://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
     <head>
         <div th:replace="~{fragment :: meta}"></div>
 
         <div th:replace="~{fragment :: styles}"></div>
         
         <!-- Flaptpickr -->
         <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
         
         <title>店舗予約</title>
     </head>
     
      <body>
		 <div class="nagoyameshi-wrapper">
			 <div th:replace="~{fragment :: header}"></div>
             
		 	 <main>
				  <div class="container pt-4 pb-5 nagoyameshi-container">
					 <div class="row justify-content-center">
						 <div class="col-xl-4 col-lg-5 col-md-8 col-sm-8">
							 <nav class="mb-4" style="--bs-breadcrumb-driver: '>';" aria-label="breadcrumb">
								 <ol class="breadcrumb mb-0">
									 <li class="breadcrumb-item"><a th:href="@{/}">トップページ</a></li>
									 <li class="breadcrumb-item"><a th:href="@{/stores}">店舗一覧</a></li>
									 <li class="breadcrumb-item"><a th:href="@{/stores/__${store.id}__}">店舗詳細</a></li>
									 <li class="breadcrumb-item active" aria-current="page">予約</li>
								 </ol>
							 </nav>
							 
							 <h1 class="mb-2 text-center" th:text="${store.name}"></h1>
							 
							 <form method="post" th:action="@{/stores/__${store.id}__/reservations/create}" th:object="${reservationRegisterForm}">
								 <div class="form-group row mb-3">
									 <label for="reservationDate" class="col-md-5 col-form-label text-md-left fw-bold">予約日</label>
									 
									 <div class="col-md-7">
										 <div th:if="${fields.hasErrors('reservationDate')}" class="text-danger small mb-2" th:errors="*{reservationDate}"></div>
										 <input type="text" class="form-control" th:field="*{reservationdate}">
									 </div>
								 </div>
								 
								 <div class="form-group row mb-3">
									 <label for="reservationTime" class="col-md-5 col-form-label text-md-left fw-bold">時間</label>
									 
									 <div class="col-md-7">
                                        <div th:if="${#fields.hasErrors('reservationTime')}" class="text-danger small mb-2" th:errors="*{reservationTime}"></div>
                                        <select class="form-control form-select" th:field="*{reservationTime}">
                                            <option value="" hidden>選択してください</option>
                                            <th:block th:with="startTime=${store.startTime}, endTime=${store.endTime}">
                                                <th:block th:each="i : ${#numbers.sequence(0, T(java.time.Duration).between(startTime, endTime).toMinutes() / 30)}">
                                                    <option th:value="${startTime.plusMinutes(i * 30)}"
                                                            th:selected="${startTime.plusMinutes(i * 30) == reservationRegisterForm.reservationTime}"
                                                            th:text="${#temporals.format(startTime.plusMinutes(i * 30), 'H:mm')}">
                                                    </option>
                                                </th:block>
                                            </th:block>
                                        </select>
                                    </div>
                                </div>
                                
                                <div class="form-group row mb-4">
                                    <label for="numberOfPeople" class="col-md-5 col-form-label text-md-left fw-bold">人数</label>

                                    <div class="col-md-7">
                                        <div th:if="${#fields.hasErrors('numberOfPeople')}" class="text-danger small mb-2" th:errors="*{numberOfPeople}"></div>
                                        <select class="form-control form-select" th:field="*{numberOfPeople}">
                                            <option value="" hidden>選択してください</option>
                                            <th:block th:each="i : ${#numbers.sequence(1, 50)}">
                                                <option th:value="${i}" th:selected="${i == reservationRegisterForm.numberOfPeople}" th:text="${i + '名'}"></option>
                                            </th:block>
                                        </select>
                                    </div>
                                </div>
                                
                                <div class="form-group d-flex justify-content-center mb-4">
                                    <button type="submit" class="btn text-white shadow-sm w-50 nagoyameshi-btn">予約する</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </main>

            <div th:replace="~{fragment :: footer}"></div>
        </div>

        <div th:replace="~{fragment :: scripts}"></div>

        <!-- Flatpickr -->
        <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
        <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/ja.js"></script>
        <script th:inline="javascript">
            const restaurantRegularHolidays = /*[[${restaurantRegularHolidays}]]*/ [];
        </script>
        <script th:src="@{/js/flatpickr.js}"></script>
    </body>
</html>